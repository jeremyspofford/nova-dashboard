<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/jpeg" href="nova-icon.jpg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <title>Aria Labs Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Light theme only -->
    <style>
        /* Celestial Design System ‚Äî Aria Labs */
        
        /* Light theme */
        :root {
            --bg-primary: #FAFAFA;
            --bg-secondary: #F8FAFC;
            --bg-tertiary: #F1F5F9;
            --text-primary: #0F172A;
            --text-secondary: #475569;
            --accent: #4F46E5;
            --accent-light: #818CF8;
            --secondary: #06B6D4;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --border: #E2E8F0;
            --shadow: rgba(79, 70, 229, 0.08);
            --glow: rgba(99, 102, 241, 0.2);
            --sidebar-width: 220px;
        }
        
        /* Light theme only */
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            transition: background 0.2s, color 0.2s;
        }
        
        /* Layout with sidebar */
        .layout {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
            padding: 1rem;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: transform 0.3s ease;
            z-index: 100;
        }
        
        .sidebar-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
            margin-bottom: 1rem;
        }
        
        .sidebar-header img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }
        
        .sidebar-header h1 {
            font-size: 1.125rem;
            font-weight: 600;
        }
        
        .sidebar-header .subtitle {
            font-size: 0.6875rem;
            color: var(--text-secondary);
        }
        
        .nav-section {
            margin-bottom: 1.5rem;
        }
        
        .nav-section h3 {
            font-size: 0.6875rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            padding: 0 0.5rem;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.625rem 0.75rem;
            border-radius: 6px;
            color: var(--text-primary);
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.15s;
            cursor: pointer;
        }
        
        .nav-link:hover {
            background: var(--bg-tertiary);
        }
        
        .nav-link.active {
            background: linear-gradient(135deg, #4F46E5 0%, #6366F1 100%);
            color: white;
            box-shadow: 0 0 20px var(--glow);
        }
        
        .nav-link .icon {
            width: 18px;
            text-align: center;
        }
        
        .sidebar-footer {
            position: absolute;
            bottom: 1rem;
            left: 1rem;
            right: 1rem;
        }
        
        .sidebar-footer .btn {
            width: 100%;
            justify-content: center;
        }
        
        /* Mobile sidebar toggle */
        .sidebar-toggle {
            display: none;
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 101;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 0.5rem 0.75rem;
            cursor: pointer;
            font-size: 1.25rem;
        }
        
        .sidebar-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 99;
        }
        
        /* Main content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 1.5rem;
        }
        
        .container { max-width: 1100px; margin: 0 auto; }
        
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.5rem 0 1.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--border);
        }
        
        .header-title {
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn {
            padding: 0.5rem 0.875rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8125rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.375rem;
            transition: all 0.15s;
        }
        
        .btn:hover { background: var(--bg-tertiary); }
        
        .btn-primary {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }
        
        .btn-primary:hover {
            opacity: 0.9;
        }
        
        /* Sections */
        .section {
            margin-bottom: 2.5rem;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.25rem;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        /* Apps Grid */
        .apps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }
        
        .app-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.25rem;
            text-decoration: none;
            color: inherit;
            transition: all 0.2s;
            box-shadow: 0 1px 3px var(--shadow);
            cursor: pointer;
        }
        
        .app-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow);
        }
        
        .app-card h3 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.625rem;
            font-size: 1rem;
            font-weight: 600;
        }
        
        .app-card .status {
            font-size: 0.625rem;
            font-weight: 600;
            padding: 0.125rem 0.5rem;
            border-radius: 10px;
            margin-left: auto;
            text-transform: uppercase;
            letter-spacing: 0.25px;
        }
        
        .app-card .status.live { background: var(--success); color: #fff; }
        .app-card .status.dev { background: var(--warning); color: #fff; }
        
        .app-card p {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.5;
        }
        
        .app-card .links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            font-size: 0.8125rem;
        }
        
        .app-card .links a {
            color: var(--accent);
            text-decoration: none;
            font-weight: 500;
        }
        
        .app-card .links a:hover { text-decoration: underline; }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.875rem;
        }
        
        .stat-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 1px 3px var(--shadow);
            cursor: pointer;
            transition: all 0.15s;
        }
        
        .stat-card:hover {
            border-color: var(--accent);
            transform: translateY(-1px);
        }
        
        .stat-card h4 {
            font-size: 0.6875rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }
        
        .stat-card .value {
            font-size: 1.375rem;
            font-weight: 700;
        }
        
        .stat-card .subtext {
            font-size: 0.6875rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }
        
        /* Charts */
        .charts-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }
        
        .chart-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem;
            box-shadow: 0 1px 3px var(--shadow);
            cursor: pointer;
            transition: all 0.15s;
        }
        
        .chart-card:hover {
            border-color: var(--accent);
        }
        
        .chart-card h4 {
            font-size: 0.8125rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }
        
        .chart-container {
            height: 180px;
            position: relative;
        }
        
        /* Kanban */
        .kanban-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
        }
        
        .kanban-column {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem;
            min-height: 180px;
            box-shadow: 0 1px 3px var(--shadow);
        }
        
        .kanban-column h4 {
            font-size: 0.8125rem;
            font-weight: 600;
            margin-bottom: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .kanban-column h4 .count {
            background: var(--bg-tertiary);
            padding: 0.125rem 0.5rem;
            border-radius: 10px;
            font-size: 0.6875rem;
            font-weight: 600;
        }
        
        .kanban-item {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            font-size: 0.8125rem;
            line-height: 1.4;
            cursor: pointer;
            transition: all 0.15s;
        }
        
        .kanban-item:hover {
            border-color: var(--accent);
            transform: translateX(2px);
        }
        
        .kanban-item:last-child { margin-bottom: 0; }
        
        .kanban-item .meta {
            font-size: 0.6875rem;
            color: var(--text-secondary);
            margin-top: 0.375rem;
        }
        
        .kanban-item.done {
            opacity: 0.75;
            border-left: 3px solid var(--success);
        }
        
        .kanban-item.in-progress {
            border-left: 3px solid var(--warning);
        }
        
        .priority-high { color: var(--error); font-weight: 600; }
        .priority-normal { color: var(--text-secondary); }
        
        /* Repos */
        .repos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 0.75rem;
        }
        
        .repo-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 0.875rem 1rem;
            text-decoration: none;
            color: inherit;
            transition: all 0.15s;
            box-shadow: 0 1px 2px var(--shadow);
            cursor: pointer;
        }
        
        .repo-card:hover { 
            border-color: var(--accent); 
            background: var(--bg-tertiary);
        }
        
        .repo-card h4 {
            font-size: 0.875rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }
        
        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }
        
        .quick-action {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.15s;
            text-decoration: none;
            color: var(--text-primary);
        }
        
        .quick-action:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent);
        }
        
        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 200;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal {
            background: var(--bg-primary);
            border: 1px solid var(--border);
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            animation: modalIn 0.2s ease;
        }
        
        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.95) translateY(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        
        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }
        
        .modal-header h2 {
            font-size: 1.125rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            padding: 0.25rem;
            line-height: 1;
        }
        
        .modal-close:hover {
            color: var(--text-primary);
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .modal-body p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            line-height: 1.6;
        }
        
        .modal-body .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border);
            font-size: 0.875rem;
        }
        
        .modal-body .detail-row:last-child {
            border-bottom: none;
        }
        
        .modal-body .detail-label {
            color: var(--text-secondary);
        }
        
        .modal-body .detail-value {
            font-weight: 500;
        }
        
        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
        }
        
        /* Status indicator */
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 0.375rem;
        }
        
        .status-dot.online { background: var(--success); }
        .status-dot.offline { background: var(--error); }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 1.5rem 1rem;
            color: var(--text-secondary);
            font-size: 0.75rem;
            border-top: 1px solid var(--border);
            margin-top: 2rem;
        }
        
        .loading { color: var(--text-secondary); font-style: italic; font-size: 0.875rem; }
        .error { color: var(--error); }
        
        /* Mobile Responsive */
        @media (max-width: 900px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .sidebar-toggle {
                display: block;
            }
            
            .sidebar-overlay.active {
                display: block;
            }
            
            .main-content {
                margin-left: 0;
                padding: 1rem;
                padding-top: 4rem;
            }
        }
        
        @media (max-width: 768px) {
            .section { margin-bottom: 2rem; }
            .section-header { font-size: 0.9375rem; margin-bottom: 1rem; }
            
            .apps-grid { 
                grid-template-columns: 1fr; 
                gap: 0.875rem;
            }
            
            .app-card { padding: 1rem; }
            .app-card h3 { font-size: 0.9375rem; }
            .app-card p { font-size: 0.8125rem; }
            
            .stats-grid { 
                grid-template-columns: repeat(2, 1fr); 
                gap: 0.625rem;
            }
            
            .stat-card { padding: 0.875rem 0.5rem; }
            .stat-card .value { font-size: 1.125rem; }
            .stat-card h4 { font-size: 0.625rem; }
            
            .charts-row { 
                grid-template-columns: 1fr; 
                gap: 0.875rem;
            }
            
            .chart-container { height: 160px; }
            
            .kanban-grid { 
                grid-template-columns: repeat(2, 1fr); 
                gap: 0.875rem;
            }
            
            .kanban-column { 
                min-height: auto; 
                padding: 0.875rem;
            }
            
            .repos-grid { 
                grid-template-columns: repeat(2, 1fr); 
                gap: 0.5rem;
            }
            
            .repo-card { padding: 0.75rem; }
            .repo-card h4 { font-size: 0.8125rem; }
            
            .quick-actions {
                flex-direction: column;
            }
            
            .modal {
                margin: 0.5rem;
                max-height: 90vh;
            }
        }
        
        @media (max-width: 480px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .repos-grid { grid-template-columns: 1fr; }
            .kanban-grid { grid-template-columns: 1fr; }
            
            header {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <button class="sidebar-toggle" onclick="toggleSidebar()">‚ò∞</button>
    <div class="sidebar-overlay" onclick="toggleSidebar()"></div>
    
    <div class="layout">
        <!-- Sidebar Navigation -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <img src="nova-icon.jpg" alt="Aria Labs">
                <div>
                    <h1>Aria Labs</h1>
                    <p class="subtitle">Aria Labs</p>
                </div>
            </div>
            
            <nav>
                <div class="nav-section">
                    <h3>Navigation</h3>
                    <a href="#apps" class="nav-link active" data-section="apps">
                        <span class="icon">üöÄ</span> Apps & Projects
                    </a>
                    <a href="#tasks" class="nav-link" data-section="tasks">
                        <span class="icon">üìã</span> Task Board
                    </a>
                    <a href="#subagents" class="nav-link" data-section="subagents">
                        <span class="icon">ü§ñ</span> Subagents
                    </a>
                    <a href="#deploys" class="nav-link" data-section="deploys">
                        <span class="icon">üöÄ</span> Recent Deploys
                    </a>
                    <a href="#metrics" class="nav-link" data-section="metrics">
                        <span class="icon">üìà</span> Metrics
                    </a>
                    <a href="#repos" class="nav-link" data-section="repos">
                        <span class="icon">üìÅ</span> Repositories
                    </a>
                </div>
                
                <div class="nav-section">
                    <h3>External Links</h3>
                    <a href="https://github.com/jeremyspofford" target="_blank" class="nav-link">
                        <span class="icon">üêô</span> GitHub
                    </a>
                    <a href="https://arialabs.ai" target="_blank" class="nav-link">
                        <span class="icon">üåê</span> Aria Labs
                    </a>
                    <a href="https://jeremyspofford.dev" target="_blank" class="nav-link">
                        <span class="icon">üë§</span> Portfolio
                    </a>
                </div>
            </nav>
            
            <div class="sidebar-footer">
                <!-- Light theme only -->
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <header>
                    <h2 class="header-title" id="page-title">Dashboard Overview</h2>
                    <div class="header-actions">
                        <button class="btn" onclick="loadAll()">‚Üª Refresh</button>
                    </div>
                </header>
                
                <!-- Quick Actions -->
                <div class="quick-actions">
                    <a href="https://github.com/jeremyspofford?tab=repositories" target="_blank" class="quick-action">
                        ‚ûï New Repo
                    </a>
                    <a href="https://dash.cloudflare.com" target="_blank" class="quick-action">
                        ‚òÅÔ∏è Cloudflare
                    </a>
                    <a href="https://supabase.com/dashboard" target="_blank" class="quick-action">
                        üóÑÔ∏è Supabase
                    </a>
                    <span class="quick-action" onclick="showSystemStatus()">
                        <span class="status-dot online"></span> System Status
                    </span>
                </div>
                
                <!-- Site Status Section -->
                <section class="section" id="site-status">
                    <h2 class="section-header">üåê Site Status</h2>
                    <div class="stats-grid" id="site-status-grid">
                        <div class="stat-card" id="status-dashboard">
                            <h4>Dashboard</h4>
                            <div class="value"><span class="status-dot online"></span>Checking...</div>
                            <div class="subtext">dashboard.arialabs.ai</div>
                        </div>
                        <div class="stat-card" id="status-reps">
                            <h4>Accountability</h4>
                            <div class="value"><span class="status-dot online"></span>Checking...</div>
                            <div class="subtext">reps.arialabs.ai</div>
                        </div>
                        <div class="stat-card" id="status-suppr">
                            <h4>Suppr</h4>
                            <div class="value"><span class="status-dot online"></span>Checking...</div>
                            <div class="subtext">suppr.arialabs.ai</div>
                        </div>
                        <div class="stat-card" id="status-portfolio">
                            <h4>Portfolio</h4>
                            <div class="value"><span class="status-dot online"></span>Checking...</div>
                            <div class="subtext">jeremyspofford.dev</div>
                        </div>
                    </div>
                </section>
                
                <!-- Apps Section -->
                <section class="section" id="apps">
                    <h2 class="section-header">üöÄ Apps & Projects</h2>
                    <div class="apps-grid" id="apps-grid">
                        <div class="app-card" onclick="showAppModal('nova')">
                            <h3>‚≠ê Nova <span class="status dev">BETA</span></h3>
                            <p>AI assistant powering Aria Labs. Persistent memory, multi-channel, proactive.</p>
                            <div class="links">
                                <a href="https://github.com/jeremyspofford/nova" target="_blank" onclick="event.stopPropagation()">GitHub</a>
                            </div>
                        </div>
                        <div class="app-card" onclick="showAppModal('accountability')">
                            <h3>üìä Accountability Dashboard <span class="status dev">BETA</span></h3>
                            <p>Track what politicians say vs what they do. 538 Congress members with real data.</p>
                            <div class="links">
                                <a href="https://reps.arialabs.ai" target="_blank" onclick="event.stopPropagation()">Live Site</a>
                                <a href="https://github.com/jeremyspofford/accountability-dashboard" target="_blank" onclick="event.stopPropagation()">GitHub</a>
                            </div>
                        </div>
                        <div class="app-card" onclick="showAppModal('suppr')">
                            <h3>üçΩÔ∏è Suppr <span class="status dev">BETA</span></h3>
                            <p>Social dining app. Host meals, find dinner companions.</p>
                            <div class="links">
                                <a href="https://suppr.arialabs.ai" target="_blank" onclick="event.stopPropagation()">Live Site</a>
                                <a href="https://github.com/jeremyspofford/suppr" target="_blank" onclick="event.stopPropagation()">GitHub</a>
                            </div>
                        </div>
                        <div class="app-card" onclick="showAppModal('portfolio')">
                            <h3>üë§ Portfolio <span class="status dev">BETA</span></h3>
                            <p>Jeremy's professional portfolio site.</p>
                            <div class="links">
                                <a href="https://jeremyspofford.dev" target="_blank" onclick="event.stopPropagation()">Live Site</a>
                                <a href="https://github.com/jeremyspofford/portfolio" target="_blank" onclick="event.stopPropagation()">GitHub</a>
                            </div>
                        </div>
                        <div class="app-card" style="opacity: 0.7" onclick="showAppModal('mercury')">
                            <h3>üìß Mercury <span class="status dev">DEV</span></h3>
                            <p>Email management CLI. Pending Gmail OAuth setup.</p>
                            <div class="links">
                                <a href="https://github.com/jeremyspofford/nova" target="_blank" onclick="event.stopPropagation()">GitHub (Nova)</a>
                            </div>
                        </div>
                        <div class="app-card" style="opacity: 0.7" onclick="showAppModal('dashboard')">
                            <h3>üì± Nova Dashboard <span class="status dev">BETA</span></h3>
                            <p>This dashboard! Monitoring and control center for Aria Labs projects.</p>
                            <div class="links">
                                <a href="https://github.com/jeremyspofford/nova-dashboard" target="_blank" onclick="event.stopPropagation()">GitHub</a>
                            </div>
                        </div>
                        <div class="app-card" style="border-color: var(--warning); border-style: dashed;" onclick="showAppModal('facedrill')">
                            <h3>üéØ FaceDrill <span class="status dev">POC</span></h3>
                            <p>Face/name flashcard app. Learn names fast with spaced repetition.</p>
                            <div class="links">
                                <a href="https://facedrill.arialabs.ai" target="_blank" onclick="event.stopPropagation()">Live Site</a>
                                <a href="https://github.com/jeremyspofford/facedrill-poc" target="_blank" onclick="event.stopPropagation()">GitHub</a>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Kanban Section -->
                <section class="section" id="tasks">
                    <h2 class="section-header">üìã Task Board</h2>
                    <div class="kanban-grid" id="kanban-grid">
                        <div class="kanban-column">
                            <h4>üî¥ In Progress <span class="count" id="inprogress-count">0</span></h4>
                            <div id="inprogress-items"></div>
                        </div>
                        <div class="kanban-column">
                            <h4>üü° Up Next <span class="count" id="upnext-count">0</span></h4>
                            <div id="upnext-items"></div>
                        </div>
                        <div class="kanban-column">
                            <h4>‚è∏Ô∏è Blocked <span class="count" id="blocked-count">0</span></h4>
                            <div id="blocked-items"></div>
                        </div>
                        <div class="kanban-column">
                            <h4>üü¢ Done Today <span class="count" id="done-count">0</span></h4>
                            <div id="done-items"></div>
                        </div>
                    </div>
                </section>
                
                <!-- Subagents Section -->
                <section class="section" id="subagents">
                    <h2 class="section-header">ü§ñ Active Subagents</h2>
                    <div id="subagents-grid" class="apps-grid">
                        <div class="loading">Loading subagents...</div>
                    </div>
                </section>
                
                <!-- Recent Deploys Section -->
                <section class="section" id="deploys">
                    <h2 class="section-header">üöÄ Recent Deploys</h2>
                    <div id="deploys-grid" class="apps-grid">
                        <div class="loading">Loading deploy status...</div>
                    </div>
                </section>
                
                <!-- Monitoring Section -->
                <section class="section" id="metrics">
                    <h2 class="section-header">üìà Metrics</h2>
                    <div id="metrics-loading" class="loading">Loading metrics...</div>
                    <div id="metrics-content" style="display: none;">
                        <div class="stats-grid" id="stats-grid"></div>
                        <div class="charts-row" id="charts-row" style="margin-top: 1rem;"></div>
                    </div>
                </section>
                
                <!-- Repos Section -->
                <section class="section" id="repos">
                    <h2 class="section-header">üìÅ Repositories</h2>
                    <div class="repos-grid" id="repos-grid">
                        <div class="loading">Loading repos...</div>
                    </div>
                </section>
                
                <footer>
                    <div id="footer-status">Loading...</div>
                </footer>
            </div>
        </main>
    </div>
    
    <!-- Modal -->
    <div class="modal-overlay" id="modal-overlay" onclick="closeModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h2 id="modal-title">Details</h2>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer" id="modal-footer">
                <button class="btn" onclick="closeModal()">Close</button>
            </div>
        </div>
    </div>
    
    <script>
        const METRICS_URL = 'metrics.json';
        const KANBAN_API = '/api/kanban';
        
        // App data for modals
        const APP_DATA = {
            nova: {
                title: '‚≠ê Nova',
                description: 'AI assistant powering Aria Labs. Features persistent memory, multi-channel support (Telegram, Discord), proactive heartbeat system, and tool integrations.',
                status: 'Beta',
                tech: 'TypeScript, OpenClaw, Claude API',
                repo: 'https://github.com/jeremyspofford/nova',
                features: ['Persistent memory across sessions', 'Multi-channel messaging', 'Proactive heartbeats', 'Tool integrations', 'Cron job scheduling']
            },
            accountability: {
                title: 'üìä Accountability Dashboard',
                description: 'Track what politicians say vs what they do. Real data from Congress.gov API covering all 538 Congress members.',
                status: 'Beta',
                url: 'https://reps.arialabs.ai',
                tech: 'Next.js, Tailwind CSS, Congress.gov API',
                repo: 'https://github.com/jeremyspofford/accountability-dashboard',
                features: ['Real Congress.gov data', 'Bill tracking', 'Voting records', 'Member profiles']
            },
            suppr: {
                title: 'üçΩÔ∏è Suppr',
                description: 'Social dining app where you can host meals or find dinner companions. MVP deployed with core features.',
                status: 'Beta',
                url: 'https://suppr.arialabs.ai',
                tech: 'Next.js, Supabase, Tailwind CSS',
                repo: 'https://github.com/jeremyspofford/suppr',
                features: ['Host dinner events', 'Find local meals', 'User profiles', 'RSVP system']
            },
            portfolio: {
                title: 'üë§ Portfolio',
                description: 'Jeremy\'s professional portfolio showcasing projects and experience.',
                status: 'Beta',
                url: 'https://jeremyspofford.dev',
                tech: 'Next.js, Tailwind CSS',
                repo: 'https://github.com/jeremyspofford/portfolio',
                features: ['Project showcase', 'Experience timeline', 'Contact form', 'SEO optimized']
            },
            mercury: {
                title: 'üìß Mercury',
                description: 'Email management CLI for inbox zero. Currently in development, pending Gmail OAuth setup.',
                status: 'Development',
                tech: 'TypeScript, Gmail API',
                repo: 'https://github.com/jeremyspofford/mercury',
                features: ['Inbox triage', 'Smart categorization', 'Quick actions', 'CLI interface']
            },
            dashboard: {
                title: 'üì± Nova Dashboard',
                description: 'Monitoring and control center for all Aria Labs projects. You\'re looking at it!',
                status: 'Beta',
                tech: 'HTML, CSS, JavaScript, Chart.js',
                repo: 'https://github.com/jeremyspofford/nova-dashboard',
                features: ['Project overview', 'Task board', 'Usage metrics', 'Real-time updates']
            },
            facedrill: {
                title: 'üéØ FaceDrill',
                description: 'Face/name flashcard app for teachers, salespeople, managers. Learn names fast with spaced repetition and timed matching games.',
                status: 'POC',
                url: 'https://facedrill.arialabs.ai',
                tech: 'Next.js, Tailwind CSS',
                repo: 'https://github.com/jeremyspofford/facedrill-poc',
                features: ['Flashcard mode', 'Timed match game', 'Photo upload', 'Deck organization', 'Spaced repetition']
            }
        };
        
        // Light theme only - no theme management needed
        
        // Sidebar toggle for mobile
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
            document.querySelector('.sidebar-overlay').classList.toggle('active');
        }
        
        // Navigation
        document.querySelectorAll('.nav-link[data-section]').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const section = link.dataset.section;
                
                // Update active state
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                link.classList.add('active');
                
                // Scroll to section
                document.getElementById(section)?.scrollIntoView({ behavior: 'smooth' });
                
                // Close mobile sidebar
                if (window.innerWidth <= 900) {
                    toggleSidebar();
                }
            });
        });
        
        // Modal functions
        function showModal(title, content, footer = '') {
            document.getElementById('modal-title').innerHTML = title;
            document.getElementById('modal-body').innerHTML = content;
            document.getElementById('modal-footer').innerHTML = footer || '<button class="btn" onclick="closeModal()">Close</button>';
            document.getElementById('modal-overlay').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeModal(e) {
            if (e && e.target !== e.currentTarget) return;
            document.getElementById('modal-overlay').classList.remove('active');
            document.body.style.overflow = '';
        }
        
        // Close modal on escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });
        
        function showAppModal(appId) {
            const app = APP_DATA[appId];
            if (!app) return;
            
            const features = app.features ? app.features.map(f => `<li>${f}</li>`).join('') : '';
            
            const content = `
                <p>${app.description}</p>
                <div class="detail-row">
                    <span class="detail-label">Status</span>
                    <span class="detail-value">${app.status}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Tech Stack</span>
                    <span class="detail-value">${app.tech}</span>
                </div>
                ${features ? `
                <div style="margin-top: 1rem;">
                    <strong style="font-size: 0.875rem;">Features</strong>
                    <ul style="margin-top: 0.5rem; padding-left: 1.25rem; color: var(--text-secondary); font-size: 0.875rem;">
                        ${features}
                    </ul>
                </div>
                ` : ''}
            `;
            
            const footer = `
                ${app.url ? `<a href="${app.url}" target="_blank" class="btn btn-primary">Visit Site</a>` : ''}
                <a href="${app.repo}" target="_blank" class="btn">View Code</a>
                <button class="btn" onclick="closeModal()">Close</button>
            `;
            
            showModal(app.title, content, footer);
        }
        
        function showTaskModal(task) {
            const content = `
                <p style="font-weight: 600; margin-bottom: 1rem;">${task.task}</p>
                ${task.assignee ? `
                <div class="detail-row">
                    <span class="detail-label">Assignee</span>
                    <span class="detail-value">üë§ ${task.assignee}</span>
                </div>
                ` : ''}
                ${task.priority ? `
                <div class="detail-row">
                    <span class="detail-label">Priority</span>
                    <span class="detail-value priority-${task.priority}">${task.priority}</span>
                </div>
                ` : ''}
                ${task.notes ? `
                <div class="detail-row">
                    <span class="detail-label">Description</span>
                    <span class="detail-value">${task.notes}</span>
                </div>
                ` : ''}
                ${task.started ? `
                <div class="detail-row">
                    <span class="detail-label">Started</span>
                    <span class="detail-value">${task.started}</span>
                </div>
                ` : ''}
                ${task.blocker ? `
                <div class="detail-row">
                    <span class="detail-label">Blocker</span>
                    <span class="detail-value" style="color: var(--error);">‚ö†Ô∏è ${task.blocker}</span>
                </div>
                ` : ''}
                ${task.outcome ? `
                <div class="detail-row">
                    <span class="detail-label">Outcome</span>
                    <span class="detail-value">${task.outcome}</span>
                </div>
                ` : ''}
                ${task.steps?.length ? `
                <div style="margin-top: 1rem;">
                    <span class="detail-label" style="display: block; margin-bottom: 0.5rem;">Steps</span>
                    <ol style="margin-left: 1.5rem; color: var(--text-secondary); font-size: 0.875rem;">
                        ${task.steps.map(s => `<li style="margin-bottom: 0.25rem;">${s}</li>`).join('')}
                    </ol>
                </div>
                ` : ''}
                ${task.acceptance_criteria?.length ? `
                <div style="margin-top: 1rem;">
                    <span class="detail-label" style="display: block; margin-bottom: 0.5rem;">Acceptance Criteria</span>
                    <ul style="margin-left: 1.5rem; color: var(--text-secondary); font-size: 0.875rem;">
                        ${task.acceptance_criteria.map(c => `<li style="margin-bottom: 0.25rem;">‚òê ${c}</li>`).join('')}
                    </ul>
                </div>
                ` : ''}
            `;
            
            showModal('üìã Task Details', content);
        }
        
        // Track page load time for uptime calculation
        const pageLoadTime = Date.now();
        
        function formatUptime(ms) {
            const seconds = Math.floor(ms / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);
            
            if (days > 0) return `${days}d ${hours % 24}h`;
            if (hours > 0) return `${hours}h ${minutes % 60}m`;
            if (minutes > 0) return `${minutes}m ${seconds % 60}s`;
            return `${seconds}s`;
        }
        
        async function showSystemStatus() {
            const uptime = formatUptime(Date.now() - pageLoadTime);
            
            // Fetch latest metrics for session count and last update
            let activeSessions = '‚Äî';
            let lastHeartbeat = '‚Äî';
            
            try {
                const res = await fetch(METRICS_URL + '?t=' + Date.now());
                const m = await res.json();
                activeSessions = m.sessions.active;
                lastHeartbeat = new Date(m.generatedAt).toLocaleString();
            } catch (err) {
                console.error('Failed to fetch system status:', err);
            }
            
            const content = `
                <div class="detail-row">
                    <span class="detail-label">Gateway</span>
                    <span class="detail-value"><span class="status-dot online"></span>Online</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Host</span>
                    <span class="detail-value">Raspberry Pi 4</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Dashboard Uptime</span>
                    <span class="detail-value">${uptime}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Active Sessions</span>
                    <span class="detail-value">${activeSessions}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Last Heartbeat</span>
                    <span class="detail-value">${lastHeartbeat}</span>
                </div>
            `;
            
            showModal('üñ•Ô∏è System Status', content);
        }
        
        // Light theme only
        
        function formatNumber(n) {
            if (n >= 1e9) return (n / 1e9).toFixed(1) + 'B';
            if (n >= 1e6) return (n / 1e6).toFixed(1) + 'M';
            if (n >= 1e3) return (n / 1e3).toFixed(0) + 'K';
            return n.toLocaleString();
        }
        
        function formatCost(n) { return '$' + n.toFixed(2); }
        
        function formatMs(ms) {
            if (ms >= 60000) return (ms / 60000).toFixed(1) + 'm';
            if (ms >= 1000) return (ms / 1000).toFixed(1) + 's';
            return ms + 'ms';
        }
        
        async function loadMetrics() {
            const loadingEl = document.getElementById('metrics-loading');
            const contentEl = document.getElementById('metrics-content');
            
            try {
                const res = await fetch(METRICS_URL + '?t=' + Date.now());
                const m = await res.json();
                
                loadingEl.style.display = 'none';
                contentEl.style.display = 'block';
                
                const successRate = m.messages.user > 0 
                    ? ((m.messages.user - m.messages.errors) / m.messages.user * 100).toFixed(0)
                    : 100;
                
                document.getElementById('stats-grid').innerHTML = `
                    <div class="stat-card" onclick="showMetricModal('messages', ${JSON.stringify(m.messages).replace(/"/g, '&quot;')})">
                        <h4>Messages</h4>
                        <div class="value">${formatNumber(m.messages.total)}</div>
                        <div class="subtext">${m.messages.user} prompts</div>
                    </div>
                    <div class="stat-card" onclick="showMetricModal('tokens', ${JSON.stringify(m.tokens).replace(/"/g, '&quot;')})">
                        <h4>Tokens</h4>
                        <div class="value">${formatNumber(m.tokens.total)}</div>
                        <div class="subtext">${formatNumber(m.tokens.output)} output</div>
                    </div>
                    <div class="stat-card" onclick="showMetricModal('cost', ${JSON.stringify(m.cost).replace(/"/g, '&quot;')})">
                        <h4>Cost (7d)</h4>
                        <div class="value">${formatCost(m.cost.total)}</div>
                        <div class="subtext">${Object.keys(m.cost.byDay).length} days</div>
                    </div>
                    <div class="stat-card">
                        <h4>Success Rate</h4>
                        <div class="value" style="color: var(--success)">${successRate}%</div>
                        <div class="subtext">${m.messages.errors} errors</div>
                    </div>
                    <div class="stat-card" onclick="showMetricModal('latency', ${JSON.stringify(m.latency).replace(/"/g, '&quot;')})">
                        <h4>Avg Latency</h4>
                        <div class="value">${formatMs(m.latency.avgMs)}</div>
                        <div class="subtext">P95: ${formatMs(m.latency.p95Ms)}</div>
                    </div>
                    <div class="stat-card">
                        <h4>Sessions</h4>
                        <div class="value">${m.sessions.active}</div>
                        <div class="subtext">active</div>
                    </div>
                `;
                
                document.getElementById('charts-row').innerHTML = `
                    <div class="chart-card">
                        <h4>Cost by Day</h4>
                        <div class="chart-container"><canvas id="costChart"></canvas></div>
                    </div>
                    <div class="chart-card">
                        <h4>Activity (24h)</h4>
                        <div class="chart-container"><canvas id="activityChart"></canvas></div>
                    </div>
                `;
                
                renderCharts(m);
                
                document.getElementById('footer-status').textContent = 
                    `Metrics updated ${new Date(m.generatedAt).toLocaleString()} ‚Ä¢ ${m.periodHours}h period`;
                    
            } catch (err) {
                loadingEl.innerHTML = `<span class="error">Failed to load metrics: ${err.message}</span>`;
            }
        }
        
        function showMetricModal(type, data) {
            let title, content;
            
            switch(type) {
                case 'messages':
                    title = 'üí¨ Message Statistics';
                    content = `
                        <div class="detail-row"><span class="detail-label">Total Messages</span><span class="detail-value">${formatNumber(data.total)}</span></div>
                        <div class="detail-row"><span class="detail-label">User Prompts</span><span class="detail-value">${data.user}</span></div>
                        <div class="detail-row"><span class="detail-label">Assistant Responses</span><span class="detail-value">${data.assistant}</span></div>
                        <div class="detail-row"><span class="detail-label">Errors</span><span class="detail-value">${data.errors}</span></div>
                    `;
                    break;
                case 'tokens':
                    title = 'üî¢ Token Usage';
                    content = `
                        <div class="detail-row"><span class="detail-label">Total Tokens</span><span class="detail-value">${formatNumber(data.total)}</span></div>
                        <div class="detail-row"><span class="detail-label">Input Tokens</span><span class="detail-value">${formatNumber(data.input)}</span></div>
                        <div class="detail-row"><span class="detail-label">Output Tokens</span><span class="detail-value">${formatNumber(data.output)}</span></div>
                        <div class="detail-row"><span class="detail-label">Cache Read</span><span class="detail-value">${formatNumber(data.cacheRead || 0)}</span></div>
                    `;
                    break;
                case 'cost':
                    title = 'üí∞ Cost Breakdown';
                    const days = Object.entries(data.byDay).sort((a,b) => b[0].localeCompare(a[0]));
                    content = `
                        <div class="detail-row"><span class="detail-label">Total (7 days)</span><span class="detail-value">${formatCost(data.total)}</span></div>
                        <div style="margin-top: 1rem;"><strong>By Day</strong></div>
                        ${days.map(([day, cost]) => `
                            <div class="detail-row"><span class="detail-label">${day}</span><span class="detail-value">${formatCost(cost)}</span></div>
                        `).join('')}
                    `;
                    break;
                case 'latency':
                    title = '‚ö° Latency Statistics';
                    content = `
                        <div class="detail-row"><span class="detail-label">Average</span><span class="detail-value">${formatMs(data.avgMs)}</span></div>
                        <div class="detail-row"><span class="detail-label">P50 (Median)</span><span class="detail-value">${formatMs(data.p50Ms)}</span></div>
                        <div class="detail-row"><span class="detail-label">P95</span><span class="detail-value">${formatMs(data.p95Ms)}</span></div>
                        <div class="detail-row"><span class="detail-label">P99</span><span class="detail-value">${formatMs(data.p99Ms)}</span></div>
                    `;
                    break;
            }
            
            showModal(title, content);
        }
        
        function renderCharts(m) {
            // Light theme colors
            const gridColor = '#d0d7de';
            const textColor = '#656d76';
            const accentColor = '#0969da';
            const successColor = '#1a7f37';
            
            const chartOpts = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    x: { ticks: { color: textColor }, grid: { color: gridColor } },
                    y: { ticks: { color: textColor }, grid: { color: gridColor } }
                }
            };
            
            // Cost chart
            const days = Object.keys(m.cost.byDay).sort().slice(-7);
            new Chart(document.getElementById('costChart'), {
                type: 'bar',
                data: {
                    labels: days.map(d => d.slice(5)),
                    datasets: [{ data: days.map(d => m.cost.byDay[d]), backgroundColor: accentColor }]
                },
                options: chartOpts
            });
            
            // Activity chart  
            const now = new Date();
            const hours = Array.from({length: 24}, (_, i) => {
                const h = new Date(now - (23-i) * 3600000);
                return h.toISOString().slice(0, 13);
            });
            new Chart(document.getElementById('activityChart'), {
                type: 'line',
                data: {
                    labels: hours.map(h => h.slice(11) + ':00'),
                    datasets: [{
                        data: hours.map(h => m.activity.byHour[h] || 0),
                        borderColor: successColor,
                        backgroundColor: 'rgba(26,127,55,0.1)',
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: chartOpts
            });
        }
        
        async function loadRepos() {
            const grid = document.getElementById('repos-grid');
            grid.innerHTML = '<div class="loading">Loading repos...</div>';
            
            try {
                // Fetch from GitHub API (public, no auth needed)
                const res = await fetch('https://api.github.com/users/jeremyspofford/repos?per_page=50&sort=pushed');
                if (!res.ok) throw new Error('GitHub API error');
                
                const repos = await res.json();
                
                // Filter out archived repos
                const activeRepos = repos.filter(r => !r.archived);
                
                if (activeRepos.length === 0) {
                    grid.innerHTML = '<div class="loading">No active repositories</div>';
                    return;
                }
                
                grid.innerHTML = activeRepos.map(repo => `
                    <a href="${repo.html_url}" target="_blank" class="repo-card" title="${repo.description || 'No description'}">
                        <h4>üì¶ ${repo.name}</h4>
                        ${repo.description ? `<p style="font-size:0.7rem;color:var(--text-secondary);margin-top:0.25rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${repo.description.slice(0, 45)}${repo.description.length > 45 ? '...' : ''}</p>` : ''}
                    </a>
                `).join('');
            } catch (err) {
                // Fallback to static list on error
                const fallback = ['nova', 'nova-dashboard', 'accountability-dashboard', 'suppr', 'portfolio', 'dotfiles', 'mercury'];
                grid.innerHTML = fallback.map(name => `
                    <a href="https://github.com/jeremyspofford/${name}" target="_blank" class="repo-card">
                        <h4>üì¶ ${name}</h4>
                    </a>
                `).join('');
            }
        }
        
        // Store kanban data globally for modal access
        let kanbanData = null;
        
        async function loadKanban() {
            try {
                const res = await fetch(KANBAN_API + '?t=' + Date.now());
                const apiResponse = await res.json();
                
                if (!apiResponse.success) {
                    throw new Error(apiResponse.error || 'Failed to load kanban data');
                }
                
                const tasks = apiResponse.data;
                
                // Transform API data to match old format
                kanbanData = {
                    inProgress: tasks.filter(t => t.status === 'in_progress').map(t => ({
                        task: `${t.task_id}: ${t.title}`,
                        priority: t.priority,
                        assignee: t.assignee,
                        notes: t.description,
                        url: t.metadata?.url,
                        steps: t.metadata?.steps,
                        acceptance_criteria: t.metadata?.acceptance_criteria,
                        started: new Date(t.updated_at).toLocaleTimeString()
                    })),
                    upNext: tasks.filter(t => t.status === 'backlog').map(t => ({
                        task: `${t.task_id}: ${t.title}`,
                        priority: t.priority,
                        assignee: t.assignee,
                        notes: t.description,
                        steps: t.metadata?.steps,
                        acceptance_criteria: t.metadata?.acceptance_criteria
                    })),
                    blocked: tasks.filter(t => t.status === 'blocked').map(t => ({
                        task: `${t.task_id}: ${t.title}`,
                        blocker: t.description || 'Unknown blocker',
                        assignee: t.assignee,
                        notes: t.description,
                        steps: t.metadata?.steps,
                        acceptance_criteria: t.metadata?.acceptance_criteria
                    })),
                    doneToday: tasks.filter(t => t.status === 'done').map(t => ({
                        task: `${t.task_id}: ${t.title}`,
                        outcome: t.metadata?.outcome || '‚úÖ Completed',
                        assignee: t.assignee,
                        time: new Date(t.updated_at).toLocaleTimeString()
                    })),
                    subagents: [],
                    recentDeploys: []
                };
                
                const k = kanbanData;
                
                // In Progress
                document.getElementById('inprogress-count').textContent = k.inProgress.length;
                document.getElementById('inprogress-items').innerHTML = k.inProgress.length 
                    ? k.inProgress.map((t, i) => `
                        <div class="kanban-item in-progress" onclick='showTaskModal(${JSON.stringify(t).replace(/'/g, "\\'")})'>
                            ${t.task}
                            <div class="meta">üë§ ${t.assignee || 'Unassigned'} ‚Ä¢ Started ${t.started || 'now'}</div>
                        </div>
                    `).join('')
                    : '<div style="color: var(--text-secondary); font-size: 0.75rem;">No active tasks</div>';
                
                // Up Next
                document.getElementById('upnext-count').textContent = k.upNext.length;
                document.getElementById('upnext-items').innerHTML = k.upNext.slice(0, 5).map((t, i) => `
                    <div class="kanban-item" onclick='showTaskModal(${JSON.stringify(t).replace(/'/g, "\\'")})'>
                        ${t.task}
                        <div class="meta">üë§ ${t.assignee || 'Unassigned'} ‚Ä¢ <span class="priority-${t.priority}">${t.priority}</span></div>
                    </div>
                `).join('') || '<div style="color: var(--text-secondary); font-size: 0.75rem;">Queue empty</div>';
                
                // Blocked
                document.getElementById('blocked-count').textContent = k.blocked?.length || 0;
                document.getElementById('blocked-items').innerHTML = k.blocked?.length
                    ? k.blocked.map((t, i) => `
                        <div class="kanban-item" onclick='showTaskModal(${JSON.stringify(t).replace(/'/g, "\\'")})' style="border-left: 3px solid var(--error);">
                            ${t.task}
                            <div class="meta">üë§ ${t.assignee || 'Unassigned'} ‚Ä¢ ‚ö†Ô∏è Blocked</div>
                        </div>
                    `).join('')
                    : '<div style="color: var(--text-secondary); font-size: 0.75rem;">No blockers</div>';
                
                // Done Today
                document.getElementById('done-count').textContent = k.doneToday.length;
                document.getElementById('done-items').innerHTML = k.doneToday.slice(0, 5).map((t, i) => `
                    <div class="kanban-item done" onclick='showTaskModal(${JSON.stringify(t).replace(/'/g, "\\'")})'>
                        ${t.task}
                        <div class="meta">${t.outcome}</div>
                    </div>
                `).join('') || '<div style="color: var(--text-secondary); font-size: 0.75rem;">Nothing yet</div>';
                
                // Subagents
                const subagentsGrid = document.getElementById('subagents-grid');
                if (k.subagents && k.subagents.length > 0) {
                    subagentsGrid.innerHTML = k.subagents.map(s => `
                        <div class="app-card" style="${s.status === 'active' ? 'border-color: var(--success);' : ''}">
                            <h3>ü§ñ ${s.label} <span class="status ${s.status === 'active' ? 'live' : 'dev'}">${s.status}</span></h3>
                            <p>${s.task}</p>
                            ${s.spawned ? `<div class="meta" style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--text-secondary);">Spawned: ${new Date(s.spawned).toLocaleString()}</div>` : ''}
                        </div>
                    `).join('');
                } else {
                    subagentsGrid.innerHTML = '<div style="color: var(--text-secondary); font-size: 0.875rem; font-style: italic;">No active subagents</div>';
                }
                
                // Recent Deploys
                const deploysGrid = document.getElementById('deploys-grid');
                if (k.recentDeploys && k.recentDeploys.length > 0) {
                    deploysGrid.innerHTML = k.recentDeploys.map(d => `
                        <div class="app-card">
                            <h3>${d.project}</h3>
                            <p style="margin: 0.5rem 0;">${d.status}</p>
                            ${d.notes ? `<p style="font-size: 0.75rem; color: var(--text-secondary);">${d.notes}</p>` : ''}
                            <div class="links">
                                <a href="${d.url}" target="_blank" onclick="event.stopPropagation()">View Site</a>
                                ${d.deployed ? `<span style="font-size: 0.75rem; color: var(--text-secondary);">${new Date(d.deployed).toLocaleString()}</span>` : ''}
                            </div>
                        </div>
                    `).join('');
                } else {
                    deploysGrid.innerHTML = '<div style="color: var(--text-secondary); font-size: 0.875rem; font-style: italic;">No recent deploys</div>';
                }
                
            } catch (err) {
                console.error('Failed to load kanban:', err);
            }
        }
        
        async function checkSiteStatus() {
            const sites = [
                { id: 'status-dashboard', url: 'https://dashboard.arialabs.ai', name: 'Dashboard' },
                { id: 'status-reps', url: 'https://reps.arialabs.ai', name: 'Accountability' },
                { id: 'status-suppr', url: 'https://suppr.arialabs.ai', name: 'Suppr' },
                { id: 'status-portfolio', url: 'https://jeremyspofford.dev', name: 'Portfolio' }
            ];
            
            for (const site of sites) {
                const card = document.getElementById(site.id);
                const startTime = Date.now();
                
                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 10000); // 10s timeout
                    
                    const response = await fetch(site.url, {
                        method: 'HEAD',
                        mode: 'no-cors', // Avoid CORS issues
                        signal: controller.signal
                    });
                    
                    clearTimeout(timeoutId);
                    const latency = Date.now() - startTime;
                    
                    // With no-cors, we can't check response.ok, but if fetch succeeds, site is up
                    card.querySelector('.value').innerHTML = 
                        `<span class="status-dot online"></span>Online`;
                    card.querySelector('.subtext').textContent = `${latency}ms`;
                    
                } catch (err) {
                    // Check if it was a timeout or network error
                    if (err.name === 'AbortError') {
                        card.querySelector('.value').innerHTML = 
                            `<span class="status-dot offline"></span>Timeout`;
                        card.querySelector('.subtext').textContent = '> 10s';
                    } else {
                        // With no-cors mode, network errors often mean the site is actually up
                        // but CORS is blocking us, so we'll assume it's online
                        const latency = Date.now() - startTime;
                        card.querySelector('.value').innerHTML = 
                            `<span class="status-dot online"></span>Online`;
                        card.querySelector('.subtext').textContent = `~${latency}ms`;
                    }
                }
            }
        }
        
        function loadAll() {
            loadMetrics();
            loadKanban();
            loadRepos();
            checkSiteStatus();
        }
        
        loadAll();
    </script>
</body>
</html>
